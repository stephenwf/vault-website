{
  "title": "Loading annotations",
  "folder": "vault",
  "body": {
    "raw": "\n### Loading annotations\n\nAnnotations can either be embedded inside the IIIF, or load externally. Vault does not determine if an Annotation page\nis embedded or not. You can check if it has been loaded previously (or attempted). An Annotation Page can be loaded\nlike other resources, with the same rules of loading.\n\n```js\nconst annotationPage = await vault.load('https://example.org/annotation-page-1');\n\nfor (const annotation of annotationPage.items) {\n    // ...\n}\n```\n\nWhen you load an Annotation Page, it will be merged with the \"snippet\" that was in the Manifest or other resources from\nwhere it was loaded. This merging can cause some information to be lost. For example, a transcription may appear in a \nManifest as:\n\n```json\n{\n  \"seeAlso\": [\n    {\n      \"id\": \"https://example.org/annotation-page-1\"\n      \"type\": \"AnnotationPage\",\n      \"label\": { \"en\": [\"Transcribed lines\"] }\n    }\n  ]\n}\n```\n\nHowever, when you load the annotation, it may have a different label - or a missing label. Vault will treat this \nresolved version of the resource as the ground truth. This may result in lost labels from the snippet.\n```json\n{\n  \"id\": \"https://example.org/annotation-page-1\"\n  \"type\": \"AnnotationPage\",\n  \"label\": { \"en\": [\"Transcribed lines of Manifest 123\"] }\n}\n```\n\nWe are looking at how best to resolve this, and if this will affect other properties that may exist only in a snippet \nor change.\n\nSolving this problem is in the [Roadmap](/docs/vault/roadmap);\n\nSimilar to Manifests/Collections you can check if an Annotation Collection is previously loaded\n\n```js\nconst status = vault.requestStatus('https://example.org/annotation-page-1');\n\nif (status.loadingState !== 'RESOURCE_LOADING') {\n  // Do something.\n}\n```\n\n### Paged annotations\n\nVault does not currently have any helpers for managing many pages of annotations. Also, it does not currently support\nloading in Presentation 2.0 annotation lists, such as search results. These are open problems that may be solved with\na combination of changes to Vault and Vault helpers.\n\nCheck the [Annotation pages](/docs/helpers/annotation-pages) page for more information.\n",
    "html": "<h3>Loading annotations</h3>\n<p>Annotations can either be embedded inside the IIIF, or load externally. Vault does not determine if an Annotation page\nis embedded or not. You can check if it has been loaded previously (or attempted). An Annotation Page can be loaded\nlike other resources, with the same rules of loading.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> annotationPage = <span class=\"hljs-keyword\">await</span> vault.<span class=\"hljs-title function_\">load</span>(<span class=\"hljs-string\">'https://example.org/annotation-page-1'</span>);\n\n<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> annotation <span class=\"hljs-keyword\">of</span> annotationPage.<span class=\"hljs-property\">items</span>) {\n    <span class=\"hljs-comment\">// ...</span>\n}\n</code></pre>\n<p>When you load an Annotation Page, it will be merged with the \"snippet\" that was in the Manifest or other resources from\nwhere it was loaded. This merging can cause some information to be lost. For example, a transcription may appear in a\nManifest as:</p>\n<pre><code class=\"hljs language-json\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">\"seeAlso\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">\"id\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"https://example.org/annotation-page-1\"</span>\n      <span class=\"hljs-attr\">\"type\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"AnnotationPage\"</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">\"label\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span> <span class=\"hljs-attr\">\"en\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-string\">\"Transcribed lines\"</span><span class=\"hljs-punctuation\">]</span> <span class=\"hljs-punctuation\">}</span>\n    <span class=\"hljs-punctuation\">}</span>\n  <span class=\"hljs-punctuation\">]</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<p>However, when you load the annotation, it may have a different label - or a missing label. Vault will treat this\nresolved version of the resource as the ground truth. This may result in lost labels from the snippet.</p>\n<pre><code class=\"hljs language-json\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">\"id\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"https://example.org/annotation-page-1\"</span>\n  <span class=\"hljs-attr\">\"type\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"AnnotationPage\"</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"label\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span> <span class=\"hljs-attr\">\"en\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-string\">\"Transcribed lines of Manifest 123\"</span><span class=\"hljs-punctuation\">]</span> <span class=\"hljs-punctuation\">}</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<p>We are looking at how best to resolve this, and if this will affect other properties that may exist only in a snippet\nor change.</p>\n<p>Solving this problem is in the <a href=\"/docs/vault/roadmap\">Roadmap</a>;</p>\n<p>Similar to Manifests/Collections you can check if an Annotation Collection is previously loaded</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> status = vault.<span class=\"hljs-title function_\">requestStatus</span>(<span class=\"hljs-string\">'https://example.org/annotation-page-1'</span>);\n\n<span class=\"hljs-keyword\">if</span> (status.<span class=\"hljs-property\">loadingState</span> !== <span class=\"hljs-string\">'RESOURCE_LOADING'</span>) {\n  <span class=\"hljs-comment\">// Do something.</span>\n}\n</code></pre>\n<h3>Paged annotations</h3>\n<p>Vault does not currently have any helpers for managing many pages of annotations. Also, it does not currently support\nloading in Presentation 2.0 annotation lists, such as search results. These are open problems that may be solved with\na combination of changes to Vault and Vault helpers.</p>\n<p>Check the <a href=\"/docs/helpers/annotation-pages\">Annotation pages</a> page for more information.</p>"
  },
  "_id": "docs/01-vault/03-loading-annotations.md",
  "_raw": {
    "sourceFilePath": "docs/01-vault/03-loading-annotations.md",
    "sourceFileName": "03-loading-annotations.md",
    "sourceFileDir": "docs/01-vault",
    "contentType": "markdown",
    "flattenedPath": "docs/01-vault/03-loading-annotations"
  },
  "type": "Docs",
  "filename": "loading-annotations",
  "url": "/docs/vault/loading-annotations"
}